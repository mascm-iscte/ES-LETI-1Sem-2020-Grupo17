<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>WindowGUI.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">WindowGUI (Dec 12, 2020 4:26:40 PM)</a> &gt; <a href="../../index.html" class="el_group">com.projeto_es</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">com.projeto_es</a> &gt; <span class="el_source">WindowGUI.java</span></div><h1>WindowGUI.java</h1><pre class="source lang-java linenums">package com.projeto_es;

import java.awt.Component;
import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.filechooser.FileNameExtensionFilter;
import javax.swing.table.DefaultTableModel;


import org.apache.poi.ss.usermodel.Workbook;

import org.apache.poi.ss.usermodel.Cell;

import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;

import javax.swing.JButton;
import javax.swing.JFileChooser;

import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.event.WindowListener;

import java.io.FileOutputStream;

import java.io.IOException;
import java.util.Vector;

import javax.swing.GroupLayout;
import javax.swing.GroupLayout.Alignment;
import javax.swing.LayoutStyle.ComponentPlacement;


import java.awt.Font;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Cursor;
import java.awt.Rectangle;

import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

public class WindowGUI {

<span class="fc" id="L52">	protected static final Component parent = null;</span>
	private JFrame frmExcelSearch;
<span class="fc" id="L54">	private Vector&lt;String&gt; headers = new Vector&lt;String&gt;();</span>
<span class="fc" id="L55">	private Vector&lt;String&gt; sub_headers = new Vector&lt;String&gt;();</span>
<span class="fc" id="L56">	private Vector&lt;Vector&lt;String&gt;&gt; data = new Vector&lt;Vector&lt;String&gt;&gt;();</span>
	private JButton btnNewButton_1;
	private JButton btnNewButton_2;
	private JButton btnNewButton_3;
<span class="fc" id="L60">	private JTable table = new JTable();</span>
	private String file_path;
	private String file_name;
	private ExcelMethods method;
	private DefaultTableModel model;
<span class="fc" id="L65">	private Workbook book = null;</span>
<span class="fc" id="L66">	private Sheet sheet = null;</span>
	private String iPlasma;
	private String PMD;
	private String isLongMethod;
	private String isFeatureEnvy;
<span class="fc" id="L71">	private boolean fileExistes = false;</span>
<span class="fc" id="L72">	private boolean changesDetected = false;</span>

	/**
	 * Launch the application.
	 */
	public static void main(String[] args) {
<span class="fc" id="L78">		EventQueue.invokeLater(new Runnable() {</span>
			public void run() {
				try {
<span class="fc" id="L81">					WindowGUI window = new WindowGUI();</span>
<span class="fc" id="L82">					window.frmExcelSearch.setVisible(true);</span>
<span class="pc" id="L83">				} catch (Exception e) {</span>
<span class="nc" id="L84">					e.printStackTrace();</span>
				}
<span class="fc" id="L86">			}</span>
		});
<span class="fc" id="L88">	}</span>

	/**
	 * Constructor
	 * Create the application.
	 */
<span class="fc" id="L94">	public WindowGUI() {</span>
<span class="fc" id="L95">		initialize();</span>
<span class="fc" id="L96">	}</span>



	/**
	 * Initialize the contents of the frame.
	 */
	public void initialize() {
<span class="fc" id="L104">		frmExcelSearch = new JFrame();</span>
<span class="fc" id="L105">		frmExcelSearch.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
<span class="fc" id="L106">		frmExcelSearch.setSize(1200, 800);</span>
<span class="fc" id="L107">		frmExcelSearch.getContentPane().setBounds(new Rectangle(1000, 1000, 1200, 800));</span>
<span class="fc" id="L108">		frmExcelSearch.getContentPane().setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="fc" id="L109">		frmExcelSearch.setForeground(Color.BLUE);</span>
<span class="fc" id="L110">		frmExcelSearch.setFont(new Font(&quot;Calibri Light&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L111">		frmExcelSearch.setTitle(&quot;Excel Search&quot;);</span>
<span class="fc" id="L112">		WindowListener exitListener = new WindowAdapter() {</span>
			
			/**
			 * @param e Click on &quot;Close&quot; icon
			 */
			@Override
			public void windowClosing(WindowEvent e) {
<span class="fc" id="L119">				int confirm = JOptionPane.showOptionDialog(</span>
<span class="fc" id="L120">						null, &quot;Are You Sure to Close Application?&quot;, </span>
<span class="fc" id="L121">						&quot;Exit Confirmation&quot;, JOptionPane.YES_NO_OPTION, </span>
<span class="fc" id="L122">						JOptionPane.QUESTION_MESSAGE, null, null, null);</span>
<span class="pc bpc" id="L123" title="1 of 2 branches missed.">				if (confirm == 0) {</span>
<span class="nc" id="L124">					System.exit(0);</span>
<span class="nc" id="L125">				} else {</span>
<span class="nc" id="L126">					return;</span>
				}
<span class="nc" id="L128">			}</span>
		};
		
<span class="fc" id="L131">		frmExcelSearch.addWindowListener(exitListener);</span>


<span class="fc" id="L134">		JButton btnNewButton = new JButton(&quot;Abrir&quot;);</span>
<span class="fc" id="L135">		btnNewButton.addMouseListener(new MouseAdapter() {</span>
			
			/**
			 * @param e Clicking on &quot;Abrir&quot; button triggers a JFileChooser that displays .xlsl files
			 */
			@Override
			public void mouseClicked(MouseEvent e) {
<span class="fc" id="L142">				JFileChooser chooser = new JFileChooser();     </span>
<span class="fc" id="L143">				FileNameExtensionFilter filter = new FileNameExtensionFilter(&quot;Excel Spreadsheet&quot;, &quot;xlsx&quot;); </span>
<span class="fc" id="L144">				chooser.setFileFilter(filter);</span>
				//Workbook book;
				//Sheet sheet;
<span class="fc" id="L147">				int returnVal = chooser.showOpenDialog(parent);     </span>
<span class="pc bpc" id="L148" title="1 of 2 branches missed.">				if(returnVal == JFileChooser.APPROVE_OPTION) {  </span>
					try {
<span class="fc" id="L150">						file_path = chooser.getCurrentDirectory().toString();</span>
<span class="fc" id="L151">						file_name = chooser.getSelectedFile().getName();</span>
<span class="fc" id="L152">						method = new ExcelMethods(book, sheet);</span>
<span class="fc" id="L153">						book = validateOS(System.getProperty(&quot;os.name&quot;).toLowerCase());</span>
<span class="fc" id="L154">						method.setWB(book);</span>
<span class="fc" id="L155">						method.setSH(book.getSheet(&quot;long-method&quot;));</span>
<span class="fc" id="L156">						headers.clear();</span>
<span class="fc bfc" id="L157" title="All 2 branches covered.">						for (int i = 0; i &lt; method.getCols(); i++) {</span>
<span class="fc" id="L158">							String headercol = method.getCellContentStr(0, i);</span>
<span class="fc" id="L159">							headers.add(headercol);</span>
						}
<span class="fc" id="L161">						data.clear();</span>
<span class="fc bfc" id="L162" title="All 2 branches covered.">						for (int i = 1; i &lt; method.getRows(); i++) {</span>
<span class="fc" id="L163">							Vector&lt;String&gt; d = new Vector&lt;String&gt;();</span>
<span class="fc bfc" id="L164" title="All 2 branches covered.">							for (int j = 0; j &lt; method.getCols(); j++) {</span>
<span class="fc" id="L165">								String auxx = method.getCellContentStr(i, j);</span>
<span class="fc" id="L166">								d.add(auxx);</span>
							}	
<span class="fc" id="L168">							d.add(&quot;\n&quot;);</span>
<span class="fc" id="L169">							data.add(d);</span>
						}

<span class="fc" id="L172">					}</span>
<span class="nc" id="L173">					catch (Exception e1) {</span>
<span class="nc" id="L174">						e1.printStackTrace();</span>
					}
<span class="fc" id="L176">					model = new DefaultTableModel(data,headers);</span>
<span class="fc" id="L177">					table.setModel(model);</span>
<span class="fc" id="L178">					table.setAutoCreateRowSorter(true);</span>
<span class="fc" id="L179">					model = new DefaultTableModel(data, headers);</span>
<span class="fc" id="L180">					table.setModel(model);</span>
<span class="fc" id="L181">					fileExistes = true;</span>
<span class="fc" id="L182">					changesDetected = true;</span>
				}
<span class="fc" id="L184">			}</span>

			/**
			 * @param os Operating System Name
			 * @return book Workbook with data from .xlsl file
			 */
			public Workbook validateOS(String os) {
<span class="pc bpc" id="L191" title="1 of 2 branches missed.">				if(os.indexOf(&quot;win&quot;)&gt;=0)</span>
<span class="fc" id="L192">					book = method.getWorkbook(file_path+&quot;\\&quot;+file_name);</span>
<span class="pc bpc" id="L193" title="1 of 2 branches missed.">				if(os.indexOf(&quot;mac&quot;)&gt;=0)</span>
<span class="nc" id="L194">					book = method.getWorkbook(file_path+&quot;//&quot;+file_name);</span>
<span class="pc bpc" id="L195" title="3 of 6 branches missed.">				if(os.indexOf(&quot;nix&quot;) &gt;= 0 || os.indexOf(&quot;nux&quot;) &gt;= 0 || os.indexOf(&quot;aix&quot;) &gt; 0)</span>
<span class="nc" id="L196">					book = method.getWorkbook(file_path+&quot;//&quot;+file_name);</span>
<span class="fc" id="L197">				return book;</span>
			}
		});

<span class="fc" id="L201">		btnNewButton_1 = new JButton(&quot;Save&quot;);</span>
<span class="fc" id="L202">		btnNewButton_1.addActionListener(new ActionListener() {</span>
			
			/**
			 * @param e Clicking on &quot;Save&quot; button triggers current table saving
			 * 
			 */
			public void actionPerformed(ActionEvent e) {
				try {
<span class="pc bpc" id="L210" title="1 of 2 branches missed.">					if(!changesDetected) {</span>
<span class="nc" id="L211">						JOptionPane.showMessageDialog(frmExcelSearch,</span>
<span class="nc" id="L212">								&quot;No changes detected!!&quot;,</span>
<span class="nc" id="L213">								&quot;Warning&quot;,</span>
<span class="nc" id="L214">								JOptionPane.WARNING_MESSAGE);</span>
<span class="nc" id="L215">						return;</span>
					}
<span class="fc" id="L217">					sheet = book.getSheet(&quot;long-method&quot;);</span>
<span class="fc" id="L218">					Row row = null;</span>
<span class="fc" id="L219">					Cell cell = null;</span>

<span class="fc" id="L221">					changesDetected = changed();</span>

<span class="pc bpc" id="L223" title="1 of 2 branches missed.">					if(changesDetected) {</span>
<span class="fc" id="L224">						Object[] options = {&quot;Yes&quot;, &quot;No&quot;};</span>

<span class="fc" id="L226">						int n = JOptionPane.showOptionDialog(frmExcelSearch,</span>
<span class="fc" id="L227">								&quot;Update workbook sheet?&quot;, &quot;Save&quot;,</span>
<span class="fc" id="L228">								JOptionPane.YES_NO_CANCEL_OPTION,</span>
<span class="fc" id="L229">								JOptionPane.QUESTION_MESSAGE,</span>
<span class="fc" id="L230">								null,</span>
<span class="fc" id="L231">								options, options[1]);</span>
<span class="pc bpc" id="L232" title="1 of 2 branches missed.">						if(n == 0) {</span>
<span class="fc bfc" id="L233" title="All 2 branches covered.">							for (int i=0;i&lt;model.getRowCount();i++) {</span>
<span class="fc" id="L234">								row = sheet.getRow(i);</span>
<span class="fc bfc" id="L235" title="All 2 branches covered.">								for (int j=0;j&lt;model.getColumnCount();j++) {</span>
<span class="fc" id="L236">									cell = row.getCell(j);</span>
<span class="fc" id="L237">									cell.setCellValue((String) model.getValueAt(i, j));</span>
								}

							}

<span class="fc" id="L242">							JFileChooser chooser = new JFileChooser(); </span>

<span class="fc" id="L244">							chooser.setCurrentDirectory(new java.io.File(&quot;.&quot;));</span>
<span class="fc" id="L245">							chooser.setDialogTitle(&quot;Select Folder.&quot;);</span>
<span class="fc" id="L246">							chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);</span>
<span class="fc" id="L247">							int returnVal = chooser.showOpenDialog(parent);     </span>
<span class="pc bpc" id="L248" title="1 of 2 branches missed.">							if(returnVal == JFileChooser.APPROVE_OPTION) {</span>
<span class="fc" id="L249">								file_path = chooser.getCurrentDirectory().toString();</span>
<span class="fc" id="L250">								String filename = JOptionPane.showInputDialog(frmExcelSearch, &quot;Enter file name (needs to have .xlsx):&quot;);</span>
<span class="fc" id="L251">								file_path = chooser.getCurrentDirectory().toString();	</span>
<span class="pc bpc" id="L252" title="1 of 2 branches missed.">								if(!filename.contains(&quot;.xlsx&quot;)) {</span>
<span class="nc" id="L253">									JOptionPane.showMessageDialog(frmExcelSearch,</span>
<span class="nc" id="L254">											&quot;Please write a valid name.&quot;,</span>
<span class="nc" id="L255">											&quot;Warning&quot;,</span>
<span class="nc" id="L256">											JOptionPane.WARNING_MESSAGE);</span>
<span class="nc" id="L257">									return;</span>
								}
<span class="fc" id="L259">								FileOutputStream out = null;</span>
<span class="fc" id="L260">								String os = System.getProperty(&quot;os.name&quot;).toLowerCase();</span>
<span class="pc bpc" id="L261" title="1 of 2 branches missed.">								if(os.indexOf(&quot;win&quot;)&gt;=0)</span>
<span class="fc" id="L262">									out = new FileOutputStream(chooser.getSelectedFile()+&quot;\\&quot;+filename);</span>
<span class="pc bpc" id="L263" title="1 of 2 branches missed.">								if(os.indexOf(&quot;mac&quot;)&gt;=0)</span>
<span class="nc" id="L264">									out = new FileOutputStream(chooser.getSelectedFile()+&quot;//&quot;+filename);</span>
<span class="pc bpc" id="L265" title="3 of 6 branches missed.">								if(os.indexOf(&quot;nix&quot;) &gt;= 0 || os.indexOf(&quot;nux&quot;) &gt;= 0 || os.indexOf(&quot;aix&quot;) &gt; 0)</span>
<span class="nc" id="L266">									out = new FileOutputStream(chooser.getSelectedFile()+&quot;//&quot;+filename);</span>
								
<span class="fc" id="L268">								book.write(out);</span>
<span class="fc" id="L269">								out.close();</span>
<span class="fc" id="L270">								JOptionPane.showMessageDialog(frmExcelSearch,</span>
<span class="fc" id="L271">										&quot;Changes saved at: &quot; + chooser.getSelectedFile(),</span>
<span class="fc" id="L272">										&quot;Warning&quot;,</span>
<span class="fc" id="L273">										JOptionPane.WARNING_MESSAGE);</span>
							} 
 
						}	

					}
<span class="pc bpc" id="L279" title="1 of 2 branches missed.">					if(!changesDetected) {</span>
<span class="nc" id="L280">						JOptionPane.showMessageDialog(frmExcelSearch,</span>
<span class="nc" id="L281">								&quot;No changes found&quot;,</span>
<span class="nc" id="L282">								&quot;Warning&quot;,</span>
<span class="nc" id="L283">								JOptionPane.WARNING_MESSAGE);</span>
					}

<span class="nc" id="L286">				} catch (IOException ex) {</span>

				}
<span class="fc" id="L289">			}</span>
			
			/**
			 * @return changesDetected &quot;TRUE&quot; if there are user changes detected in the current table
			 */
			public boolean changed() {
<span class="pc bpc" id="L295" title="1 of 2 branches missed.">				for (int i=0;i&lt;model.getRowCount();i++) {</span>
<span class="pc bpc" id="L296" title="1 of 2 branches missed.">					for (int j=0;j&lt;model.getColumnCount();j++) {</span>
<span class="pc bpc" id="L297" title="1 of 2 branches missed.">						if(!table.getValueAt(i, j).equals(method.getCellContentStr(i, j))) {</span>
<span class="fc" id="L298">							changesDetected = true;</span>
<span class="fc" id="L299">							return changesDetected;</span>
						}
					}

				}
				
<span class="nc" id="L305">				return changesDetected;</span>
			}});






<span class="fc" id="L313">		btnNewButton_2 = new JButton(&quot;Thresholds&quot;);</span>
<span class="fc" id="L314">		btnNewButton_2.addActionListener(new ActionListener() {</span>
			
			/**
			 * @param e Clicked on &quot;Thresholds&quot; button
			 */
			public void actionPerformed(ActionEvent e) {
<span class="pc bpc" id="L320" title="1 of 2 branches missed.">				if(!fileExistes) {</span>
<span class="nc" id="L321">					showWarning(&quot;No file opened!&quot;);</span>
<span class="nc" id="L322">					return;</span>
				}

<span class="fc" id="L325">				Object[] options = {&quot;Default&quot;, &quot;is_long_method metrics&quot;, &quot;is_feature_envy metrics&quot;, &quot;Create&quot;};</span>
<span class="fc" id="L326">				int n = JOptionPane.showOptionDialog(frmExcelSearch,</span>
<span class="fc" id="L327">						&quot;Thresholds Options&quot;, &quot;Save&quot;,</span>
<span class="fc" id="L328">						JOptionPane.YES_NO_CANCEL_OPTION,</span>
<span class="fc" id="L329">						JOptionPane.QUESTION_MESSAGE,</span>
<span class="fc" id="L330">						null,</span>
<span class="fc" id="L331">						options, options[3]);</span>
<span class="fc bfc" id="L332" title="All 2 branches covered.">				if(n==0) {</span>
<span class="fc" id="L333">					DefaultThresholds dt = new DefaultThresholds();</span>
<span class="fc" id="L334">					Object[] optionsDefault = {&quot;Default is_Long_Method&quot;, &quot;Default is_feature_envy&quot;};</span>
<span class="fc" id="L335">					int nDefault = JOptionPane.showOptionDialog(frmExcelSearch,</span>
<span class="fc" id="L336">							&quot;Thresholds Options&quot;, &quot;Save&quot;,</span>
<span class="fc" id="L337">							JOptionPane.YES_NO_CANCEL_OPTION,</span>
<span class="fc" id="L338">							JOptionPane.QUESTION_MESSAGE,</span>
<span class="fc" id="L339">							null,</span>
<span class="fc" id="L340">							optionsDefault, optionsDefault[1]);</span>
<span class="fc bfc" id="L341" title="All 2 branches covered.">					if(nDefault == 0) {</span>
<span class="fc" id="L342">						String LOC = dt.getLoc(), CYCLO = dt.getCyclo();</span>
<span class="fc" id="L343">						makeTableLongMethod(LOC,CYCLO);</span>
					}

<span class="fc bfc" id="L346" title="All 2 branches covered.">					if(nDefault == 1) {</span>
<span class="fc" id="L347">						String ATFD = dt.getATFD(), LAA = dt.getLAA();</span>
<span class="fc" id="L348">						makeTableFeature(ATFD,LAA);</span>
					}

<span class="fc" id="L351">					showWarning(&quot;Applied default thresholds&quot;);</span>
<span class="fc bfc" id="L352" title="All 2 branches covered.">				} else if(n==1) {</span>
<span class="fc" id="L353">					String LOC = JOptionPane.showInputDialog(frmExcelSearch, &quot;Enter new LOC threshold:&quot;);</span>
<span class="pc bpc" id="L354" title="1 of 2 branches missed.">					if(LOC == null) {</span>
<span class="nc" id="L355">						showWarning(&quot;Error please add a value.&quot;);</span>
<span class="nc" id="L356">						return;</span>
					}
<span class="fc" id="L358">					String CYCLO = JOptionPane.showInputDialog(frmExcelSearch, &quot;Enter new CYCLO threshold:&quot;);</span>
<span class="pc bpc" id="L359" title="1 of 2 branches missed.">					if(CYCLO == null) {</span>
<span class="nc" id="L360">						showWarning(&quot;Error please add a value.&quot;);</span>
<span class="nc" id="L361">						return;</span>
					}
<span class="fc" id="L363">					makeTableLongMethod(LOC, CYCLO);</span>
<span class="pc bpc" id="L364" title="1 of 2 branches missed.">				} else if(n==2) {</span>

<span class="fc" id="L366">					String ATFD = JOptionPane.showInputDialog(frmExcelSearch, &quot;Enter new ATFD threshold:&quot;);</span>
<span class="pc bpc" id="L367" title="1 of 2 branches missed.">					if(ATFD == null) {</span>
<span class="nc" id="L368">						showWarning(&quot;Error please add a value.&quot;);</span>
<span class="nc" id="L369">						return;</span>
					}
<span class="fc" id="L371">					String LAA = JOptionPane.showInputDialog(frmExcelSearch, &quot;Enter new LAA threshold:&quot;);</span>
<span class="pc bpc" id="L372" title="1 of 2 branches missed.">					if(LAA == null) {</span>
<span class="nc" id="L373">						showWarning(&quot;Error please add a value.&quot;);</span>
<span class="nc" id="L374">						return;</span>
					}
<span class="fc" id="L376">					makeTableFeature(ATFD, LAA);</span>

<span class="pc bnc" id="L378" title="All 2 branches missed.">				}else if(n==3){</span>
					// add method here
<span class="nc" id="L380">					showWarning(&quot;Applied Created thresholds&quot;);</span>
				}


<span class="fc" id="L384">			}</span>
			
			/**
			 * @param ATFD number of accessed methods from other classes for given method
			 * @param LAA number of accessed method from own class for given method
			 */
			public void makeTableFeature(String ATFD, String LAA) {
<span class="fc" id="L391">				int ATFD_metric = Integer.parseInt(ATFD);</span>
<span class="fc" id="L392">				double LAA_metric = Double.parseDouble(LAA);</span>
<span class="fc" id="L393">				sub_headers.add(&quot;MethodID&quot;);</span>
<span class="fc" id="L394">				sub_headers.add(&quot;Defeito iPlasma&quot;);</span>
<span class="fc" id="L395">				sub_headers.add(&quot;Defeito PMD&quot;);</span>
<span class="fc" id="L396">				FeatureEnvyThresholds featureEnvy = new FeatureEnvyThresholds (ATFD_metric, LAA_metric);</span>
<span class="fc" id="L397">				JTable long_table = new JTable();</span>
<span class="fc" id="L398">				Vector&lt;Vector&lt;String&gt;&gt; fe_values = new Vector&lt;Vector&lt;String&gt;&gt;();</span>
<span class="fc" id="L399">				Vector&lt;Vector&lt;String&gt;&gt; sub_values = new Vector&lt;Vector&lt;String&gt;&gt;();</span>
<span class="fc" id="L400">				JTable sub_table = new JTable();</span>
<span class="fc" id="L401">				int atfd = 0;</span>
<span class="fc" id="L402">				double laa = 0;</span>
<span class="fc bfc" id="L403" title="All 2 branches covered.">				for(int i = 1; i &lt; method.getRows(); i++){</span>
<span class="fc" id="L404">					Vector&lt;String&gt; fe_rows = new Vector&lt;String&gt;();</span>
<span class="fc" id="L405">					Vector&lt;String&gt; sub_rows = new Vector&lt;String&gt;();</span>
<span class="fc bfc" id="L406" title="All 2 branches covered.">					for(int j = 0; j &lt;= method.getCols() + 1; j++){</span>
<span class="fc bfc" id="L407" title="All 2 branches covered.">						if(j == 6){</span>
<span class="fc" id="L408">							String atfd_str = method.getCellContentStr(i, j);</span>
<span class="fc" id="L409">							atfd = Integer.parseInt(atfd_str);</span>
<span class="fc" id="L410">							fe_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc" id="L411">							j++;</span>
<span class="fc" id="L412">							String laa_str = method.getCellContentStr(i, j);</span>
<span class="fc" id="L413">							laa = Double.parseDouble(laa_str);</span>
<span class="fc" id="L414">							fe_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc" id="L415">						}</span>
<span class="fc bfc" id="L416" title="All 2 branches covered.">						else if (j==9) {</span>
<span class="fc" id="L417">							String iPlasma_str = method.getCellContentStr(i, j);</span>
<span class="fc bfc" id="L418" title="All 2 branches covered.">							if(iPlasma_str.equals(&quot;TRUE&quot;)) {</span>
<span class="fc" id="L419">								iPlasma = &quot;TRUE&quot;;</span>
<span class="fc" id="L420">							}</span>
							else {
<span class="fc" id="L422">								iPlasma = &quot;FALSE&quot;;</span>
							}
<span class="fc" id="L424">							fe_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc" id="L425">							j++;</span>
<span class="fc" id="L426">							String PMD_str = method.getCellContentStr(i, j);</span>
<span class="fc bfc" id="L427" title="All 2 branches covered.">							if(PMD_str == &quot;TRUE&quot;) {</span>
<span class="fc" id="L428">								PMD = &quot;TRUE&quot;;</span>
<span class="fc" id="L429">							}</span>
							else {
<span class="fc" id="L431">								PMD = &quot;FALSE&quot;;</span>
							}
<span class="fc" id="L433">							fe_rows.add(method.getCellContentStr(i, j));</span>

<span class="fc" id="L435">						}</span>

<span class="fc bfc" id="L437" title="All 2 branches covered.">						else if(j==11) {</span>
<span class="fc bfc" id="L438" title="All 2 branches covered.">							if(featureEnvy.isFeatureEnvy(atfd, laa, ATFD_metric, LAA_metric)) {</span>
<span class="fc" id="L439">								isFeatureEnvy = &quot;TRUE&quot;;</span>
<span class="fc" id="L440">								fe_rows.add(&quot;TRUE&quot;);</span>
<span class="fc" id="L441">							}</span>

							else {
<span class="fc" id="L444">								isFeatureEnvy = &quot;FALSE&quot;;</span>
<span class="fc" id="L445">								fe_rows.add(&quot;FALSE&quot;);</span>
							}

<span class="fc" id="L448">						}</span>
<span class="fc bfc" id="L449" title="All 2 branches covered.">						else if (j == method.getCols()) {</span>
							String qualityMethod;
<span class="fc" id="L451">							QualityFactors factor = new QualityFactors();</span>
<span class="fc" id="L452">							qualityMethod = factor.whatFactor(iPlasma, isFeatureEnvy);</span>
<span class="fc" id="L453">							sub_rows.add(qualityMethod);</span>
<span class="fc" id="L454">						}</span>
<span class="fc bfc" id="L455" title="All 2 branches covered.">						else if (j &gt;= method.getCols()) {</span>
							String qualityMethod;
<span class="fc" id="L457">							QualityFactors factor = new QualityFactors();</span>
<span class="fc" id="L458">							qualityMethod = factor.whatFactor(PMD, isFeatureEnvy);</span>
<span class="fc" id="L459">							sub_rows.add(qualityMethod);</span>
<span class="fc" id="L460">						}</span>
						else{
<span class="fc" id="L462">							fe_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc bfc" id="L463" title="All 2 branches covered.">							if(j == 0) {</span>
<span class="fc" id="L464">								sub_rows.add(method.getCellContentStr(i, j));</span>
							}
						}
<span class="fc" id="L467">					}fe_values.add(fe_rows);</span>
<span class="fc" id="L468">					sub_values.add(sub_rows);</span>
				}

<span class="fc" id="L471">				DefaultTableModel long_model = new DefaultTableModel(fe_values,headers);</span>
<span class="fc" id="L472">				final DefaultTableModel sub_model = new DefaultTableModel(sub_values, sub_headers);</span>
<span class="fc" id="L473">				long_table.setModel(long_model);</span>
<span class="fc" id="L474">				sub_table.setModel(sub_model);</span>
<span class="fc" id="L475">				sub_headers.clear();</span>
<span class="fc" id="L476">				long_table.setAutoCreateRowSorter(true);</span>
<span class="fc" id="L477">				sub_table.setAutoCreateRowSorter(true);</span>
<span class="fc" id="L478">				JFrame long_frame = new JFrame();</span>
<span class="fc" id="L479">				JFrame sub_frame = new JFrame();</span>
<span class="fc" id="L480">				JScrollPane long_scroll = new JScrollPane(long_table);</span>
<span class="fc" id="L481">				JScrollPane sub_scroll = new JScrollPane(sub_table);</span>
<span class="fc" id="L482">				long_frame.setSize(800, 600);</span>
<span class="fc" id="L483">				sub_frame.setSize(400, 300);</span>
				//long_frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
<span class="fc" id="L485">				long_frame.getContentPane().setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="fc" id="L486">				sub_frame.getContentPane().setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="fc" id="L487">				long_frame.setTitle(&quot;is_feature_envy Search&quot;);</span>
<span class="fc" id="L488">				sub_frame.setTitle(&quot;is_feature_envy Results&quot;);</span>
<span class="fc" id="L489">				BorderLayout border = new BorderLayout();</span>
<span class="fc" id="L490">				sub_frame.setLayout(border);</span>
<span class="fc" id="L491">				long_frame.setVisible(true);</span>
<span class="fc" id="L492">				long_frame.setResizable(true);</span>
<span class="fc" id="L493">				long_frame.add(long_scroll);</span>
<span class="fc" id="L494">				sub_frame.setVisible(true);</span>
<span class="fc" id="L495">				sub_frame.setResizable(true);</span>
<span class="fc" id="L496">				sub_frame.add(sub_scroll, BorderLayout.CENTER);</span>
<span class="fc" id="L497">				JTextField sub_footer = new JTextField();</span>
<span class="fc" id="L498">				sub_footer.setText(&quot;Metrics: ATFD = &quot;+ ATFD + &quot; LAA = &quot; + LAA + &quot; (is_feature_envy)&quot;);</span>
<span class="fc" id="L499">				sub_footer.setEditable(false);</span>

<span class="fc" id="L501">				sub_frame.add(sub_footer, BorderLayout.SOUTH);</span>

<span class="fc" id="L503">			}</span>
			
			/**
			 * @param LOC number of lines of code for given method
			 * @param CYCLO cyclomatic complexity for given method
			 */
			public void makeTableLongMethod(String LOC, String CYCLO) {
<span class="fc" id="L510">				int LOC_metric = Integer.parseInt(LOC);</span>
<span class="fc" id="L511">				int CYCLO_metric = Integer.parseInt(CYCLO);</span>
<span class="fc" id="L512">				LongMethodThresholds longMethod = new LongMethodThresholds (LOC_metric, CYCLO_metric);</span>
<span class="fc" id="L513">				JTable long_table = new JTable();</span>
<span class="fc" id="L514">				JTable sub_table = new JTable();</span>
<span class="fc" id="L515">				Vector&lt;Vector&lt;String&gt;&gt; loc_values = new Vector&lt;Vector&lt;String&gt;&gt;();</span>
<span class="fc" id="L516">				Vector&lt;Vector&lt;String&gt;&gt; sub_values = new Vector&lt;Vector&lt;String&gt;&gt;();</span>
<span class="fc" id="L517">				int loc = 0;</span>
<span class="fc" id="L518">				int cyclo = 0;</span>
<span class="fc" id="L519">				sub_headers.add(&quot;MethodID&quot;);</span>
<span class="fc" id="L520">				sub_headers.add(&quot;Defeito iPlasma&quot;);</span>
<span class="fc" id="L521">				sub_headers.add(&quot;Defeito PMD&quot;);</span>
<span class="fc bfc" id="L522" title="All 2 branches covered.">				for(int i = 1; i &lt; method.getRows(); i++){</span>
<span class="fc" id="L523">					Vector&lt;String&gt; loc_rows = new Vector&lt;String&gt;();</span>
<span class="fc" id="L524">					Vector&lt;String&gt; sub_rows = new Vector&lt;String&gt;();</span>
<span class="fc bfc" id="L525" title="All 2 branches covered.">					for(int j = 0; j &lt;= method.getCols() + 1; j++){</span>
<span class="fc bfc" id="L526" title="All 2 branches covered.">						if(j == 4){</span>
<span class="fc" id="L527">							String loc_str = method.getCellContentStr(i, j);</span>
<span class="fc" id="L528">							loc = Integer.parseInt(loc_str);</span>
<span class="fc" id="L529">							loc_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc" id="L530">							j++;</span>
<span class="fc" id="L531">							String cyclo_str = method.getCellContentStr(i, j);</span>
<span class="fc" id="L532">							cyclo = Integer.parseInt(cyclo_str);</span>
<span class="fc" id="L533">							loc_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc" id="L534">						}</span>

<span class="fc bfc" id="L536" title="All 2 branches covered.">						else if(j==8) {</span>
<span class="fc bfc" id="L537" title="All 2 branches covered.">							if(longMethod.isLongMethod(loc, cyclo,LOC_metric, CYCLO_metric)) {</span>
<span class="fc" id="L538">								isLongMethod = &quot;TRUE&quot;;</span>
<span class="fc" id="L539">								loc_rows.add(&quot;TRUE&quot;);</span>
<span class="fc" id="L540">							}</span>

							else {
<span class="fc" id="L543">								isLongMethod = &quot;FALSE&quot;;</span>
<span class="fc" id="L544">								loc_rows.add(&quot;FALSE&quot;);</span>
							}
<span class="fc" id="L546">						}</span>
<span class="fc bfc" id="L547" title="All 2 branches covered.">						else if (j==9) {</span>
<span class="fc" id="L548">							String iPlasma_str = method.getCellContentStr(i, j);</span>
<span class="fc bfc" id="L549" title="All 2 branches covered.">							if(iPlasma_str.equals(&quot;TRUE&quot;)) {</span>
<span class="fc" id="L550">								iPlasma = &quot;TRUE&quot;;</span>
<span class="fc" id="L551">							}</span>
							else {
<span class="fc" id="L553">								iPlasma = &quot;FALSE&quot;;</span>
							}
<span class="fc" id="L555">							loc_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc" id="L556">							j++;</span>
<span class="fc" id="L557">							String PMD_str = method.getCellContentStr(i, j);</span>
<span class="fc bfc" id="L558" title="All 2 branches covered.">							if(PMD_str == &quot;TRUE&quot;) {</span>
<span class="fc" id="L559">								PMD = &quot;TRUE&quot;;</span>
<span class="fc" id="L560">							}</span>
							else {
<span class="fc" id="L562">								PMD = &quot;FALSE&quot;;</span>
							}
<span class="fc" id="L564">							loc_rows.add(method.getCellContentStr(i, j));</span>

<span class="fc" id="L566">						}</span>

<span class="fc bfc" id="L568" title="All 2 branches covered.">						else if (j == method.getCols()) {</span>
							String qualityMethod;
<span class="fc" id="L570">							QualityFactors factor = new QualityFactors();</span>
<span class="fc" id="L571">							qualityMethod = factor.whatFactor(iPlasma, isLongMethod);</span>
<span class="fc" id="L572">							sub_rows.add(qualityMethod);</span>
<span class="fc" id="L573">						}</span>
<span class="fc bfc" id="L574" title="All 2 branches covered.">						else if (j &gt;= method.getCols()) {</span>
							String qualityMethod;
<span class="fc" id="L576">							QualityFactors factor = new QualityFactors();</span>
<span class="fc" id="L577">							qualityMethod = factor.whatFactor(PMD, isLongMethod);</span>
<span class="fc" id="L578">							sub_rows.add(qualityMethod);</span>
<span class="fc" id="L579">						}</span>

						else{
<span class="fc" id="L582">							loc_rows.add(method.getCellContentStr(i, j));</span>
<span class="fc bfc" id="L583" title="All 2 branches covered.">							if (j == 0) {</span>
<span class="fc" id="L584">								sub_rows.add(method.getCellContentStr(i, j));</span>
							}
						}
<span class="fc" id="L587">					}loc_values.add(loc_rows);</span>
<span class="fc" id="L588">					sub_values.add(sub_rows);</span>
				}

<span class="fc" id="L591">				DefaultTableModel long_model = new DefaultTableModel(loc_values,headers);</span>
<span class="fc" id="L592">				DefaultTableModel sub_model = new DefaultTableModel(sub_values, sub_headers);</span>
<span class="fc" id="L593">				long_table.setModel(long_model);</span>
<span class="fc" id="L594">				sub_table.setModel(sub_model);</span>
<span class="fc" id="L595">				sub_headers.clear();</span>
<span class="fc" id="L596">				long_table.setAutoCreateRowSorter(true);</span>
<span class="fc" id="L597">				sub_table.setAutoCreateRowSorter(true);</span>
<span class="fc" id="L598">				JFrame long_frame = new JFrame();</span>
<span class="fc" id="L599">				JFrame sub_frame = new JFrame();</span>
<span class="fc" id="L600">				JScrollPane long_scroll = new JScrollPane(long_table);</span>
<span class="fc" id="L601">				JScrollPane sub_scroll = new JScrollPane(sub_table);</span>
<span class="fc" id="L602">				long_frame.setSize(800, 600);</span>
<span class="fc" id="L603">				sub_frame.setSize(400, 300);</span>
				//long_frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
<span class="fc" id="L605">				long_frame.getContentPane().setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="fc" id="L606">				sub_frame.getContentPane().setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="fc" id="L607">				long_frame.setTitle(&quot;is_long_method Search&quot;);</span>
<span class="fc" id="L608">				sub_frame.setTitle(&quot;is_long_method Results&quot;);</span>
<span class="fc" id="L609">				BorderLayout border = new BorderLayout();</span>
<span class="fc" id="L610">				sub_frame.setLayout(border);</span>
<span class="fc" id="L611">				long_frame.setVisible(true);</span>
<span class="fc" id="L612">				long_frame.setResizable(true);</span>
<span class="fc" id="L613">				long_frame.add(long_scroll);</span>
<span class="fc" id="L614">				sub_frame.setVisible(true);</span>
<span class="fc" id="L615">				sub_frame.setResizable(true);</span>
<span class="fc" id="L616">				sub_frame.add(sub_scroll, BorderLayout.CENTER);</span>
<span class="fc" id="L617">				JTextField sub_footer = new JTextField();</span>
<span class="fc" id="L618">				sub_footer.setText(&quot;Metrics: LOC = &quot;+ LOC + &quot; CYCLO = &quot; + CYCLO + &quot; (is_long_method)&quot;);</span>
<span class="fc" id="L619">				sub_footer.setEditable(false);</span>
<span class="fc" id="L620">				sub_frame.add(sub_footer, BorderLayout.SOUTH);</span>


<span class="fc" id="L623">			}</span>
		});



<span class="fc" id="L628">		btnNewButton_3 = new JButton(&quot;Procurar&quot;);</span>

<span class="fc" id="L630">		JScrollPane scrollPane = new JScrollPane(table);</span>
<span class="fc" id="L631">		GroupLayout groupLayout = new GroupLayout(frmExcelSearch.getContentPane());</span>
<span class="fc" id="L632">		groupLayout.setHorizontalGroup(</span>
<span class="fc" id="L633">				groupLayout.createParallelGroup(Alignment.LEADING)</span>
<span class="fc" id="L634">				.addGroup(groupLayout.createSequentialGroup()</span>
<span class="fc" id="L635">						.addGap(20)</span>
<span class="fc" id="L636">						.addComponent(btnNewButton, GroupLayout.PREFERRED_SIZE, 99, GroupLayout.PREFERRED_SIZE)</span>
<span class="fc" id="L637">						.addGap(18)</span>
<span class="fc" id="L638">						.addComponent(btnNewButton_2)</span>
<span class="fc" id="L639">						.addGap(18)</span>
<span class="fc" id="L640">						.addComponent(btnNewButton_1)</span>
<span class="fc" id="L641">						.addPreferredGap(ComponentPlacement.RELATED, 792, Short.MAX_VALUE)</span>
<span class="fc" id="L642">						.addComponent(btnNewButton_3)</span>
<span class="fc" id="L643">						.addGap(22))</span>
<span class="fc" id="L644">				.addComponent(scrollPane, GroupLayout.DEFAULT_SIZE, 1184, Short.MAX_VALUE)</span>
				);
<span class="fc" id="L646">		groupLayout.setVerticalGroup(</span>
<span class="fc" id="L647">				groupLayout.createParallelGroup(Alignment.TRAILING)</span>
<span class="fc" id="L648">				.addGroup(groupLayout.createSequentialGroup()</span>
<span class="fc" id="L649">						.addComponent(scrollPane, GroupLayout.DEFAULT_SIZE, 709, Short.MAX_VALUE)</span>
<span class="fc" id="L650">						.addGap(18)</span>
<span class="fc" id="L651">						.addGroup(groupLayout.createParallelGroup(Alignment.BASELINE)</span>
<span class="fc" id="L652">								.addComponent(btnNewButton_1)</span>
<span class="fc" id="L653">								.addComponent(btnNewButton)</span>
<span class="fc" id="L654">								.addComponent(btnNewButton_2)</span>
<span class="fc" id="L655">								.addComponent(btnNewButton_3))</span>
<span class="fc" id="L656">						.addContainerGap())</span>
				);
<span class="fc" id="L658">		frmExcelSearch.getContentPane().setLayout(groupLayout);</span>
<span class="fc" id="L659">	}</span>
	
	private void showWarning(String war){	
<span class="fc" id="L662">		JOptionPane.showMessageDialog(frmExcelSearch,</span>
<span class="fc" id="L663">			war,</span>
<span class="fc" id="L664">			&quot;Warning&quot;,</span>
<span class="fc" id="L665">			JOptionPane.WARNING_MESSAGE);</span>
<span class="fc" id="L666">	}</span>
	
}



</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span>WindowGUI (Dec 12, 2020 4:26:40 PM)</div></body></html>